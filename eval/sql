DROP DATABASE IF EXISTS `jarditou`;
CREATE DATABASE `jarditou`;
USE `jarditou`;

CREATE TABLE client(
    cli_id INT NOT NULL AUTO_INCREMENT,
    cli_type BOOLEAN,
    cli_nom VARCHAR(50) NOT NULL,
    cli_prenom VARCHAR(50) NOT NULL,
    cli_adresse VARCHAR(100) NOT NULL,
    cli_ville VARCHAR(10) NOT NULL,
    cli_tel VARCHAR(10) NOT NULL,
    cli_mail VARCHAR(50) NOT NULL,
    PRIMARY KEY (cli_id)
    );

CREATE TABLE commande(
    com_id INT NOT NULL AUTO_INCREMENT,
    com_dateCommande DATE NOT NULL,
    com_dateLivraison DATE NOT NULL,
    com_etatCommande VARCHAR(25) NOT NULL,
    com_editionFacture BIT(1),
    cli_id INT NOT NULL,
    PRIMARY KEY (com_id),
    FOREIGN KEY (cli_id) REFERENCES client (cli_id)
    );

CREATE TABLE panier(
    pan_quantiProduit INT NOT NULL,
    pan_prixVentePar FLOAT NOT NULL,
    pan_prixVentePro FLOAT NOT NULL,
    pro_code CHAR(6) NOT NULL,
    com_id INT NOT NULL,
    PRIMARY KEY (pro_code, com_id),
    FOREIGN KEY (com_id) REFERENCES commande (com_id)
);

CREATE TABLE fournisseur(
    fourni_id INT NOT NULL AUTO_INCREMENT,
    fourni_nom VARCHAR(50) NOT NULL,
    fourni_adress VARCHAR(100) NOT NULL,
    fourni_cp CHAR(5) NOT NULL,
    fourni_ville VARCHAR(50) NOT NULL,
    fourni_tel VARCHAR(10) NOT NULL,
    fourni_mail VARCHAR(50) NOT NULL,
    fourni_type BIT(1) NOT NULL,
    PRIMARY KEY (fourni_id)
);

CREATE TABLE rubrique(
    rubri_id INT NOT NULL AUTO_INCREMENT,
    rubri_lib VARCHAR(50),
    PRIMARY KEY (rubri_id)
);

CREATE TABLE produit(
    pro_code CHAR(6) NOT NULL,
    prod_lib VARCHAR(100) NOT NULL,
    prod_desc VARCHAR(250),
    prod_phot VARCHAR(250),
    prod_affichage BIT(1),
    prod_prixAchat INT NOT NULL,
    prod_stockPhy INT NOT NULL,
    prod_stockAlerte INT NOT NULL,
    fourni_id INT NOT NULL,
    rubri_id INT NOT NULL,
    PRIMARY KEY (pro_code),
    CONSTRAINT FK_produitFourni FOREIGN KEY (fourni_id) REFERENCES fournisseur (fourni_id),
    CONSTRAINT FK_produitRubrique FOREIGN KEY (rubri_id) REFERENCES rubrique (rubri_id)
);

ALTER TABLE panier
ADD FOREIGN KEY (pro_code) REFERENCES produit (pro_code);