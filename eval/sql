DROP DATABASE IF EXISTS `jarditou`;
CREATE DATABASE `jarditou`;
USE `jarditou`;

CREATE TABLE client(
    cli_id INT NOT NULL AUTO_INCREMENT,
    cli_type BOOLEAN,
    cli_nom VARCHAR(50) NOT NULL,
    cli_prenom VARCHAR(50) NOT NULL,
    cli_adresse VARCHAR(100) NOT NULL,
    cli_cp CHAR(5) NOT NULL,
    cli_ville VARCHAR(10) NOT NULL,
    cli_tel VARCHAR(10) NOT NULL,
    cli_mail VARCHAR(50) NOT NULL,
    PRIMARY KEY (cli_id)
    );

CREATE TABLE commande(
    com_id INT NOT NULL AUTO_INCREMENT,
    com_dateCommande DATE NOT NULL,
    com_dateLivraison DATE NOT NULL,
    com_etatCommande VARCHAR(25) NOT NULL,
    com_editionFacture BIT(1),
    cli_id INT NOT NULL,
    PRIMARY KEY (com_id),
    FOREIGN KEY (cli_id) REFERENCES client (cli_id)
    );

CREATE TABLE panier(
    pan_quantiProduit INT NOT NULL,
    pan_prixVentePar FLOAT NOT NULL,
    pan_prixVentePro FLOAT NOT NULL,
    pro_code CHAR(6) NOT NULL,
    com_id INT NOT NULL,
    PRIMARY KEY (pro_code, com_id),
    FOREIGN KEY (com_id) REFERENCES commande (com_id)
);

CREATE TABLE fournisseur(
    fourni_id INT NOT NULL AUTO_INCREMENT,
    fourni_nom VARCHAR(50) NOT NULL,
    fourni_adress VARCHAR(100) NOT NULL,
    fourni_cp CHAR(5) NOT NULL,
    fourni_ville VARCHAR(50) NOT NULL,
    fourni_tel VARCHAR(10) NOT NULL,
    fourni_mail VARCHAR(50) NOT NULL,
    fourni_type BIT(1) NOT NULL,
    PRIMARY KEY (fourni_id)
);

CREATE TABLE rubrique(
    rubri_id INT NOT NULL AUTO_INCREMENT,
    rubri_lib VARCHAR(50),
    PRIMARY KEY (rubri_id)
);

CREATE TABLE produit(
    pro_code CHAR(6) NOT NULL,
    prod_lib VARCHAR(100) NOT NULL,
    prod_desc VARCHAR(250),
    prod_phot VARCHAR(250),
    prod_affichage BIT(1),
    prod_prixAchat INT NOT NULL,
    prod_stockPhy INT NOT NULL,
    prod_stockAlerte INT NOT NULL,
    fourni_id INT NOT NULL,
    rubri_id INT NOT NULL,
    PRIMARY KEY (pro_code),
    CONSTRAINT FK_produitFourni FOREIGN KEY (fourni_id) REFERENCES fournisseur (fourni_id),
    CONSTRAINT FK_produitRubrique FOREIGN KEY (rubri_id) REFERENCES rubrique (rubri_id)
);

ALTER TABLE panier
ADD FOREIGN KEY (pro_code) REFERENCES produit (pro_code);

CREATE INDEX index_nom_client ON client (cli_nom);

CREATE INDEX index_date_commande ON commande (com_dateCommande);

INSERT INTO client (cli_nom, cli_prenom, cli_adresse, cli_cp, cli_ville, cli_tel, cli_mail)
 VALUES ('Djibril', 'Clement', '11 rue de garenne', '20111', 'Amiens', '0647589663', 'terje250@tubidu.com'),
 ('Rali', 'Romain', '11 rue de safd', '60000', 'Beauvais', '0647589663', 'asfa@sd.com'),
 ('Kere', 'Karim', '11 rue de boulanger', '76000', 'Rouen', '0647589663', 'seee@ged.fr'),
 ('Goui', 'Seydina', '11 rue de la verdure', '59000', 'Calais', '0647589663', 'sedere@petit.com'),
 ('Douosd', 'Clement', '11 rue de careme', '13000', 'Marseille', '0647589663', 'rss@ripo.com'),
 ('Goeoeo', 'Paul', '11 rue de la calle', '30000', 'Nîmes', '0647589663', 'elo@la.fr'),
 ('Wiou', 'Ibo', '11 rue des deporté', '59000', 'Lens', '0647589663', 'boudina@gmail.com'),
 ('Qthil', 'Arthur', '11 rue de asfd', '67000', 'Strasbourg', '0647589663', 'fautei@dsaf.ce'),
 ('DjAibril', 'Johny', '11 rue de bonojour', '33000', 'Bordeaux', '0647589663', 'asdfasdf@colo.com'),
 ('Ribbril', 'Quentin', '11 rue de rip', '44000', 'Nantes', '0647589663', 'commentaitr@rubi.com');

